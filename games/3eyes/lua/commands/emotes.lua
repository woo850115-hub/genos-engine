-- emotes.lua — 3eyes social/emote commands (action.c, 39개)
-- 테이블 구동 방식: {cmd, self_no_target, room_no_target, self_target, victim_target, room_target}

local EMOTES = {
    {"감정표현", "당신은 감정을 표현합니다.", "$n이(가) 감정을 표현합니다.",
     "당신은 $N에게 감정을 표현합니다.", "$n이(가) 당신에게 감정을 표현합니다.", "$n이(가) $N에게 감정을 표현합니다."},
    {"보아", "당신은 주위를 둘러봅니다.", "$n이(가) 주위를 둘러봅니다.",
     "당신은 $N을(를) 쳐다봅니다.", "$n이(가) 당신을 쳐다봅니다.", "$n이(가) $N을(를) 쳐다봅니다."},
    {"노려봐", "당신은 무섭게 노려봅니다.", "$n이(가) 무섭게 노려봅니다.",
     "당신은 $N을(를) 무섭게 노려봅니다.", "$n이(가) 당신을 무섭게 노려봅니다.", "$n이(가) $N을(를) 무섭게 노려봅니다."},
    {"끄덕", "당신은 고개를 끄덕입니다.", "$n이(가) 고개를 끄덕입니다.",
     "당신은 $N에게 고개를 끄덕입니다.", "$n이(가) 당신에게 고개를 끄덕입니다.", "$n이(가) $N에게 고개를 끄덕입니다."},
    {"응", "당신은 고개를 끄덕입니다.", "$n이(가) 고개를 끄덕입니다.",
     "당신은 $N에게 고개를 끄덕입니다.", "$n이(가) 당신에게 고개를 끄덕입니다.", "$n이(가) $N에게 고개를 끄덕입니다."},
    {"아니", "당신은 고개를 젓습니다.", "$n이(가) 고개를 젓습니다.",
     "당신은 $N에게 고개를 젓습니다.", "$n이(가) 당신에게 고개를 젓습니다.", "$n이(가) $N에게 고개를 젓습니다."},
    {"감사", "당신은 감사의 표시를 합니다.", "$n이(가) 감사의 표시를 합니다.",
     "당신은 $N에게 감사합니다.", "$n이(가) 당신에게 감사합니다.", "$n이(가) $N에게 감사합니다."},
    {"감", "당신은 감사의 표시를 합니다.", "$n이(가) 감사의 표시를 합니다.",
     "당신은 $N에게 감사합니다.", "$n이(가) 당신에게 감사합니다.", "$n이(가) $N에게 감사합니다."},
    {"미소", "당신은 부드럽게 미소짓습니다.", "$n이(가) 부드럽게 미소짓습니다.",
     "당신은 $N에게 미소짓습니다.", "$n이(가) 당신에게 미소짓습니다.", "$n이(가) $N에게 미소짓습니다."},
    {"떨어", "당신은 부들부들 떨고 있습니다.", "$n이(가) 부들부들 떨고 있습니다.",
     "당신은 $N 앞에서 부들부들 떱니다.", "$n이(가) 당신 앞에서 부들부들 떱니다.", "$n이(가) $N 앞에서 부들부들 떱니다."},
    {"해", "당신은 활짝 웃습니다.", "$n이(가) 활짝 웃습니다.",
     "당신은 $N에게 활짝 웃어 보입니다.", "$n이(가) 당신에게 활짝 웃어 보입니다.", "$n이(가) $N에게 활짝 웃어 보입니다."},
    {"하품", "당신은 크게 하품을 합니다.", "$n이(가) 크게 하품을 합니다.",
     nil, nil, nil},
    {"웃어", "당신은 크게 웃습니다. 하하!", "$n이(가) 크게 웃습니다. 하하!",
     "당신은 $N을(를) 보며 웃습니다.", "$n이(가) 당신을 보며 웃습니다.", "$n이(가) $N을(를) 보며 웃습니다."},
    {"미안", "당신은 미안해합니다.", "$n이(가) 미안해합니다.",
     "당신은 $N에게 미안해합니다.", "$n이(가) 당신에게 미안해합니다.", "$n이(가) $N에게 미안해합니다."},
    {"악수", "당신은 악수를 청합니다.", "$n이(가) 악수를 청합니다.",
     "당신은 $N과(와) 악수합니다.", "$n이(가) 당신과 악수합니다.", "$n이(가) $N과(와) 악수합니다."},
    {"하이파이브", "당신은 하이파이브를 합니다!", "$n이(가) 하이파이브를 합니다!",
     "당신은 $N과(와) 하이파이브!", "$n이(가) 당신과 하이파이브!", "$n이(가) $N과(와) 하이파이브!"},
    {"박수", "당신은 박수를 칩니다. 짝짝짝!", "$n이(가) 박수를 칩니다. 짝짝짝!",
     "당신은 $N에게 박수를 보냅니다.", "$n이(가) 당신에게 박수를 보냅니다.", "$n이(가) $N에게 박수를 보냅니다."},
    {"흡연", "당신은 담배를 피웁니다.", "$n이(가) 담배를 피웁니다.",
     nil, nil, nil},
    {"담배", "당신은 담배를 피웁니다.", "$n이(가) 담배를 피웁니다.",
     nil, nil, nil},
    {"절", "당신은 공손히 절합니다.", "$n이(가) 공손히 절합니다.",
     "당신은 $N에게 공손히 절합니다.", "$n이(가) 당신에게 공손히 절합니다.", "$n이(가) $N에게 공손히 절합니다."},
    {"찔러", "당신은 뾰족한 것으로 찌르는 시늉을 합니다.", "$n이(가) 뾰족한 것으로 찌르는 시늉을 합니다.",
     "당신은 $N을(를) 콕 찌릅니다.", "$n이(가) 당신을 콕 찌릅니다.", "$n이(가) $N을(를) 콕 찌릅니다."},
    {"춤", "당신은 신나게 춤을 춥니다!", "$n이(가) 신나게 춤을 춥니다!",
     "당신은 $N과(와) 함께 춤을 춥니다!", "$n이(가) 당신과 함께 춤을 춥니다!", "$n이(가) $N과(와) 함께 춤을 춥니다!"},
    {"노래", "당신은 노래를 부릅니다. 랄랄라~", "$n이(가) 노래를 부릅니다. 랄랄라~",
     "당신은 $N에게 노래를 불러줍니다.", "$n이(가) 당신에게 노래를 불러줍니다.", "$n이(가) $N에게 노래를 불러줍니다."},
    {"울어", "당신은 슬프게 웁니다. 엉엉...", "$n이(가) 슬프게 웁니다. 엉엉...",
     "당신은 $N 앞에서 웁니다.", "$n이(가) 당신 앞에서 웁니다.", "$n이(가) $N 앞에서 웁니다."},
    {"달래", nil, nil,
     "당신은 $N을(를) 달래줍니다.", "$n이(가) 당신을 달래줍니다.", "$n이(가) $N을(를) 달래줍니다."},
    {"당황", "당신은 당황합니다.", "$n이(가) 당황합니다.",
     "당신은 $N 때문에 당황합니다.", "$n이(가) 당신 때문에 당황합니다.", "$n이(가) $N 때문에 당황합니다."},
    {"윙크", "당신은 의미심장하게 윙크합니다.", "$n이(가) 의미심장하게 윙크합니다.",
     "당신은 $N에게 윙크합니다.", "$n이(가) 당신에게 윙크합니다.", "$n이(가) $N에게 윙크합니다."},
    {"뽀뽀", nil, nil,
     "당신은 $N에게 뽀뽀합니다!", "$n이(가) 당신에게 뽀뽀합니다!", "$n이(가) $N에게 뽀뽀합니다!"},
    {"바이", "당신은 손을 흔들며 인사합니다.", "$n이(가) 손을 흔들며 인사합니다.",
     "당신은 $N에게 손을 흔들며 인사합니다.", "$n이(가) 당신에게 손을 흔들며 인사합니다.", "$n이(가) $N에게 손을 흔들며 인사합니다."},
    {"잘가", "당신은 손을 흔들며 인사합니다.", "$n이(가) 손을 흔들며 인사합니다.",
     "당신은 $N에게 손을 흔들며 인사합니다.", "$n이(가) 당신에게 손을 흔들며 인사합니다.", "$n이(가) $N에게 손을 흔들며 인사합니다."},
    {"안녕", "당신은 밝게 인사합니다. 안녕!", "$n이(가) 밝게 인사합니다. 안녕!",
     "당신은 $N에게 인사합니다. 안녕!", "$n이(가) 당신에게 인사합니다. 안녕!", "$n이(가) $N에게 인사합니다. 안녕!"},
    {"설레", "당신은 가슴이 두근두근 합니다.", "$n이(가) 가슴이 두근두근 하는 것 같습니다.",
     "당신은 $N 때문에 가슴이 설렙니다.", "$n이(가) 당신 때문에 설레는 것 같습니다.", "$n이(가) $N 때문에 설레는 것 같습니다."},
    {"놀려", nil, nil,
     "당신은 $N을(를) 놀립니다.", "$n이(가) 당신을 놀립니다.", "$n이(가) $N을(를) 놀립니다."},
    {"생각", "당신은 깊은 생각에 잠깁니다.", "$n이(가) 깊은 생각에 잠깁니다.",
     "당신은 $N에 대해 생각합니다.", "$n이(가) 당신에 대해 생각합니다.", "$n이(가) $N에 대해 생각합니다."},
    {"부끄러", "당신은 얼굴이 빨개집니다.", "$n이(가) 얼굴이 빨개집니다.",
     "당신은 $N 앞에서 부끄러워합니다.", "$n이(가) 당신 앞에서 부끄러워합니다.", "$n이(가) $N 앞에서 부끄러워합니다."},
    {"구걸", "당신은 구걸합니다.", "$n이(가) 구걸합니다.",
     "당신은 $N에게 구걸합니다.", "$n이(가) 당신에게 구걸합니다.", "$n이(가) $N에게 구걸합니다."},
    {"구박", nil, nil,
     "당신은 $N을(를) 구박합니다.", "$n이(가) 당신을 구박합니다.", "$n이(가) $N을(를) 구박합니다."},
    {"안아", nil, nil,
     "당신은 $N을(를) 꼭 안아줍니다.", "$n이(가) 당신을 꼭 안아줍니다.", "$n이(가) $N을(를) 꼭 안아줍니다."},
    {"껴안아", nil, nil,
     "당신은 $N을(를) 꼭 껴안습니다.", "$n이(가) 당신을 꼭 껴안습니다.", "$n이(가) $N을(를) 꼭 껴안습니다."},
}

-- Message substitution: $n → actor name, $N → target name
local function sub_msg(msg, actor_name, target_name)
    if not msg then return nil end
    msg = msg:gsub("$n", actor_name)
    if target_name then msg = msg:gsub("$N", target_name) end
    return msg
end

-- Generic emote handler
local function do_emote(emote)
    return function(ctx, args)
        local ch = ctx.char
        if not ch then return end
        local actor = ch.name

        if not args or args == "" then
            -- No target
            if not emote[2] then
                ctx:send("누구에게 하시겠습니까?")
                return
            end
            ctx:send(sub_msg(emote[2], actor))
            ctx:send_room(sub_msg(emote[3], actor))
        else
            -- With target
            if not emote[4] then
                ctx:send("그 표현은 대상 없이만 사용할 수 있습니다.")
                return
            end
            local target = ctx:find_char(args)
            if not target then
                ctx:send("그런 사람을 찾을 수 없습니다.")
                return
            end
            if target == ch then
                ctx:send("자기 자신에게요?")
                return
            end
            ctx:send(sub_msg(emote[4], actor, target.name))
            ctx:send_to(target, sub_msg(emote[5], actor, target.name))
            ctx:send_room(sub_msg(emote[6], actor, target.name))
        end
    end
end

-- Register all emotes
for _, emote in ipairs(EMOTES) do
    register_command(emote[1], do_emote(emote))
end
